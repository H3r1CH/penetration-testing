# Vulnerability Scanning

## Nessus

### Download

{% embed url="https://www.tenable.com/downloads/nessus?loginAttempted=true" %}

### Install

```bash
dpkg -i Nessus-<version>.deb
# - You can start Nessus Scanner by typing /etc/init.d/nessusd start
# - You can start Nessus Scanner by typing /bin/systemctl start nessusd.service
# - Then go to https://kali:8834/ to configure your scanner
```

### Setup

* Wait for initialization to complete which includes compiling plugins.
* Select Nessus Essentials (if no license was purchased).
* Get an activation code by entering in your information.
* Enter in activation code.
* Login.

### Scanning

* New Scan
  * Basic Network Scan
  * Advanced Scan

## OpenVAS

### Installation

### Initial Configuration

Begin by navigating to _Scans --> Tasks_ and clicking on the purple magic wand icon to begin the basic configuration wizard. We recommend beginning a scan on `127.0.0.1` to test out your installation and ensure it is working properly.

If you successfully navigated to the wizard you should see a pop-up wizard. This is where you will set up your initial scan against your localhost to ensure everything is properly configured.

The scan may take a while to complete, so allow OpenVAS enough time to finish the scan, and then you will be met with a new dashboard for monitoring and analyzing your complete and ongoing scans.

Once your scan has finished you can navigate to _Scans --> Reports_ and click on your newly created report from your previous task.

If correctly configured you should see three different vulnerabilities reported all originating from OpenVAS itself. This is normal behavior and can be configured/changed to maintain your OpSec.

### Scanning Infrastructure

#### Creating a Task

1. Navigate to _Scans --> Tasks_.
2. Select the start icon in the upper right-hand corner of the _Tasks_ dashboard and select _New Task_
3. Once you select New Task from the dropdown you will be met with a large pop-up with many options.
   1. Name: Allows us to set the name the scan will be known as inside of OpenVAS
   2. Scan Targets: The targets to scan, can include Hosts, Ports, and Credentials. To create a new target you will need to follow another pop-up, this will be covered later in this task.
   3. Scanner: The scanner to use by default will use the OpenVAS architecture however you can set this to any scanner of your choosing in the settings menu.
   4. Scan Config: OpenVAS has seven different scan types you can select from and will be used based on how you aggressive or what information you want to collect from your scan.

#### Scoping a New Target

1. Navigate to the star icon next to _Scan Targets_.
2. The two main options you will need to configure are the Name and the Hosts.
3. Now that we have our target scoped we can continue to create our task and begin the scan.
4. Once you create the task you will be brought back to the scan dashboard where you can monitor and start your task.&#x20;
5. To start the task navigate to the start icon under _Actions_.

### Reporting and Continuous Monitoring

#### Breaking Down the Report

The automated report from OpenVAS begins with some basic host and task information including Host, Start, End, and Vulnerability categories. It will also check for host authentications and an overall summary of open ports on the host.

After the basic host and task information OpenVAS will report on each of the vulnerabilities found.

We can gather a summary of the vulnerability, detection details, mitigation details, and method of detection.

#### Continuous Monitoring Overview

OpenVAS offers many options for continuous and scheduled monitoring/vulnerability management. If you work in a team or a pipeline this can allow you to efficiently and quickly optimize your current solutions. Examples of continuous vulnerability scanning utilities are Alerts, Schedules, and Agents.

#### Creating Schedules

To begin creating a schedule navigate to _Configuration --> Schedules_ and as always click on the blue star icon in the upper left-hand corner.

Fill out the basic information like Name, First Start Time, Period, etc. Once you have the schedule created you can now create a new Task/Scan with this created schedule attached.

#### Crafting Alerts

The process for creating alerts is very similar to creating a schedule, navigate to _Configuration --> Alerts_ and click on the blue star icon in the upper left-hand corner.

You will notice that there are a lot more options than the schedule menu, don't let this intimidate you, the process is very similar and straightforward. The main options you will need to worry about are Name, Event, Condition, and To Address. The event can be configured to alert based on the status of the scan or when a new NVT/vulnerability is detected. The condition option will make sure that your inbox isn't flooded with alerts, this can be changed based on severity or filters. The To Address is fairly self-explanatory and will send an email of the alert to the specified mail address. Once created you will again need to connect the alert to a new Task/Scan.
