# JWT Attacks

## Exploiting JWT Flaws

### Check for Sensitive Data

JWTs are just base64 encoded data that can be easily decode at: [https://jwt.io/](https://jwt.io/)

Look for any sensitive or interesting information.

### Arbitrary Signature

> If the code is using `jwt.verify` the secret key will need to be obtained (cracked) to use when attempting to send a modified payload data request. i.e. replacing username with admin.
>
> If the code is using `jwt.decode` the secret key will not be needed (or can be anything) so modifying the payload data request and resending it will work if otherwise valid

If the code is using the Node.js library `jsonwebtoken` with the `jwt.decode` function above, the `alg` header value can be modified from `RS256` to `HS256` and then the payload values can attempted to be modified such as change a standard user to an admin user.

### No Signature

Similar to the example above, the `alg` header value can be modified to be set to `none` and then the payload values can be attempted to be modified such as changing a standard user to an admin user

## Brute Forcing

### Cracking JWTs

If the JWT secret key can be cracked, that key can be used to sign the token which allows payload values to be attempted to be modified such as changing a standard user to an admin user

#### jwt\_tool

[https://github.com/ticarpi/jwt\_tool](https://github.com/ticarpi/jwt\_tool)

```bash
jwt_tool '<JWT TOKEN>' --crack -d /opt/jwt_tool/jwt-common.txt
```

#### hashcat

```bash
# Dictionary attack
hachcat -a 0 -m 16500 jwt.txt passlist.txt
# Rule-based attack
hashcat -a 0 -m 16500 jwt.txt passlist.txt -r rules/best64.rul
```

## PortSwigger Labs

### JWT authentication bypass via unverified signature

* Logged in with standard credentials
* Attempted to access /admin but got unauthorized
* Intercepted the previous request, copied the JWT session cookie, and pasted it into jwt.io
* Modified the `alg` header value from `RHS256` to `HS256`
* Modified the `sub` payload value from wiener to `administrator`
* Resent the request for /admin and successfully got access

### JWT authentication bypass via flawed signature verification

* Logged in with standard credentials
* Attempted to access /admin but got unauthorized
* Intercepted the previous request and sent to Repeater
* Highlighted the payload part in the request and modified that using Inspector to set the `sub` value to `administrator`
* Highlighted the header part in the request and modified that using Inspector to set the `alg` value to `none`
* Resent the request for /admin and successfully got access

### JWT authentication bypass via weak signing key

* Logged in with standard credentials
* Attempted to access /admin but got unauthorized
* Intercepted the previous request and sent to Repeater
* Copied the whole JWT session cookie and cracked the secret with hashcat
  * `hashcat -a 0 -m 16500 '<JWT Token>' jwt.secrets.list`
* Copied the whole JWT session cookie and placed it into jwt.io replacing the `sub` value of wiener to administrator and placing in the cracked secret into the Verify Signature section
* Copied the whole encoded output of the above changes and placed it into the Cookie session of the intercepted request
* Resent the request for /admin and successfully got access

## Appendix

### Resources

[https://portswigger.net/web-security/jwt](https://portswigger.net/web-security/jwt)

[https://www.sjoerdlangkemper.nl/2016/09/28/attacking-jwt-authentication/](https://www.sjoerdlangkemper.nl/2016/09/28/attacking-jwt-authentication/)

### Other Tools

[https://github.com/brendan-rius/c-jwt-cracker](https://github.com/brendan-rius/c-jwt-cracker)

[https://github.com/jmaxxz/jwtbrute](https://github.com/jmaxxz/jwtbrute)
