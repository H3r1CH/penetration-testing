# IDOR (Insecure Direct Object Reference)

## IDOR

[https://portswigger.net/web-security/access-control/idor](https://portswigger.net/web-security/access-control/idor)

Insecure direct object references (IDOR) are a type of [access control](https://portswigger.net/web-security/access-control) vulnerability that arises when an application uses user-supplied input to access objects directly.

## Examples

### Database Objects

Customer Number used directly as a record index in queries performed against a database.

`https://insecure-website.com/customer_account?customer_number=132355`

### Static Files

Text file on the server-side filesystem where an attacker can modify/increment filename.

`https://insecure-website.com/static/12144.txt`

### User ID

User ID value where an attacker could potentially change to view other user's information.

`http://online-service.thm/profile?user_id=1305`

### User ID Address

Typical request and response that we may be able to manipulate

```yaml
https://example.com/api/user/167865/address

Response:
{
    "id":167865,
    "username":"nahamsec",
    "address":"1234 another street"
}
```

Let's say we change the ID...

```yaml
https://example.com/api/user/1/address

Response:
{
    "id":1,
    "username":"admin",
    "address":"1234 another street"
}
```

May be able to access other user's resources..

### User ID Profile

Capture the PUT request for modifying/updating a user.

```yaml
PUT https://example.com/api/user/profile HTTP/1.1

{
    "id":167865,
    "username":"nahamsec",
    "address":"me@gmail.com"
}

Response:
{"success":"true"}
```

If we know the ID for admin or other user we can try to override that user with a new one we create/own.

```yaml
PUT https://example.com/api/user/profile HTTP/1.1

{
    "id":1,
    "username":"nahamsec1",
    "address":"me+1@gmail.com"
}

Response:
{"success":"true"}
```

## Finding IDORs

### Encodings

Check to see if any data being passed is encoded i.e. base64, then try to decode it.

`eyJpZCI6MzB9` --> `{"id":30}` --> tamper --> `{"id":10}` --> encode --> `eyJpZCI6MTB9` --> Submit

### Hashes

Check to see if any data being passed is hashed, try to identify the hash, then try to crack it.

### Unpredictable IDs

If the Id cannot be detected using the above methods, an excellent method of IDOR detection is to create two accounts and swap the Id numbers between them. If you can view the other users' content using their Id number while still being logged in with a different account (or not logged in at all), you've found a valid IDOR vulnerability.

### Locations

The vulnerable endpoint you're targeting may not always be something you see in the address bar. It could be content your browser loads in via an AJAX request or something that you find referenced in a JavaScript file.&#x20;

Sometimes endpoints could have an unreferenced parameter that may have been of some use during development and got pushed to production. For example, you may notice a call to **/user/details** displaying your user information (authenticated through your session). But through an attack known as parameter mining, you discover a parameter called **user\_id** that you can use to display other users' information, for example, **/user/details?user\_id=123**.

