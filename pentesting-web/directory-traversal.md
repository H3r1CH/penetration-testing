# Directory Traversal

## LFI

### Payloads

### RCE through Apache/Nginx Log Files

### RCE through PHP Session Files (Session Poisoning)

### Other checks i.e. /proc/

#### /proc/$1$/cmdline

It's possible to identify a user and a process they are running by Intruding on the proc ID (1 to 1000) and then sorting by response length. May find the specific user and the service that they are running. Can then search for exploits based on the service running.

#### /proc/self/environ LFI Method

If it’s possible to include `/proc/self/environ` from your vulnerable LFI script, then code execution can be leveraged by manipulating the `User Agent` parameter with Burp. After the PHP code has been introduced `/proc/self/environ` can be executed via your vulnerable LFI script.

#### /proc/self/fd/ LFI Method

Similar to the previous `/proc/self/environ` method, it’s possible to introduce code into the proc log files that can be executed via your vulnerable LFI script. Typically you would use burp or curl to inject PHP code into the `referer`.

This method is a little tricky as the proc file that contains the Apache error log information changes under `/proc/self/fd/` e.g. `/proc/self/fd/2`, `/proc/self/fd/10` etc. I’d recommend brute forcing the directory structure of the /proc/self/fd/ directory with Burp Intruder + FuzzDB’s [LFI-FD-Check.txt](https://github.com/tennc/fuzzdb/blob/master/dict/BURP-PayLoad/LFI/LFI-FD-check.txt) list of likely proc files, you can then monitor the returned page sizes and investigate.

### PHP Wrappers ... or put in payloads???

## RFI

### Payloads

## PortSwigger Notes

## PortSwigger Labs

