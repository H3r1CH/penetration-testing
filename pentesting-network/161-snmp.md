# 161 (SNMP)

## Enumeration

### Checks

* [ ] Try the default community strings 'public' and 'private'
* [ ] Enumerate version of OS, users, and processes

### Community Strings

|                        |                  |
| ---------------------- | ---------------- |
| 1.3.6.1.2.1.25.1.6.0   | System Processes |
| 1.3.6.1.2.1.25.4.2.1.2 | Running Programs |
| 1.3.6.1.2.1.25.4.2.1.4 | Process Path     |
| 1.3.6.1.2.1.25.2.3.1.4 | Storage Units    |
| 1.3.6.1.2.1.25.6.3.1.2 | Software Name    |
| 1.3.6.1.4.1.77.1.2.25  | User Accounts    |
| 1.3.6.1.2.1.6.13.1.3   | TCP Local Ports  |

### Commands

#### nmap

```bash
nmap -sU -p161 --script "snmp-*" <IP>
```

### Brute Force Community Strings

```bash
# try 100+ community strings
onesixtyone -c /home/liodeus/wordlist/SecLists/Discovery/SNMP/common-snmp-community-strings-onesixtyone.txt <IP>
onesixtyone -c /usr/share/seclists/Discovery/SNMP/common-snmp-community-strings.txt <IP>
# only try "public" and "private"
onesixtyone -i targets.list
```

#### snmpwalk

```bash
snmpwalk -c public -v1 192.168.1.101 #community string and which version
# enumerate windows users
snmpwalk -c public -v1 192.168.11.204 1.3.6.1.4.1.77.1.2.25 
# enumerates running processes
snmpwalk -c public -v1 192.168.11.204 1.3.6.1.2.1.25.4.2.1.2 
```

```bash
snmpwalk -v 2c -c public <IP>
snmpwalk -v 2c -c public <IP> hrSWInstalledName
snmpwalk -v 2c -c public <IP> hrMemorySize
snmpwalk -v 2c -c public <IP> sysContact  # Get the sysContatact variable i.e. nikos
snmpset -v 2c -c public <IP> sysContact.0 s els  # Change sysContact variable to els

```

#### snmpbulkwalk

```bash
snmpbulkwalk -c <COMMUNITY_STRING> -v <VERSION> <IP>
```

#### snmp-check

```bash
snmp-check <IP>
snmp-check -t <IP> -c public
```

### Enumerate Info with Known Community String

```bash
snmpwalk -c public -v1 192.168.1.101 #community string and which version
# enumerate windows users
snmpwalk -c public -v1 192.168.11.204 1.3.6.1.4.1.77.1.2.25 
# enumerates running processes
snmpwalk -c public -v1 192.168.11.204 1.3.6.1.2.1.25.4.2.1.2 
```

### Modifying SNMP Values

```bash
http://net-snmp.sourceforge.net/tutorial/tutorial-5/commands/snmpset.html
```
