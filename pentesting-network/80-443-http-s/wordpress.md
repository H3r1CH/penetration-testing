# WordPress

## Interesting Files

* wp-content
* wp-content/plugins
* wp-admin
* wp-config.php
* wp-trackback.php
* wp-login.php

```
-rwxr-xr-x  1 www-data www-data   405 Feb  6  2020 index.php
-rwxr-xr-x  1 www-data www-data 19915 Jan  1  2021 license.txt
-rwxr-xr-x  1 www-data www-data  7346 Sep 30 00:41 readme.html
-rwxr-xr-x  1 www-data www-data  7165 Jan 21  2021 wp-activate.php
drwxr-xr-x  9 www-data www-data  4096 Nov 10 14:18 wp-admin
-rwxr-xr-x  1 www-data www-data   351 Feb  6  2020 wp-blog-header.php
-rwxr-xr-x  1 www-data www-data  2328 Feb 17  2021 wp-comments-post.php
-rwxr-xr-x  1 www-data www-data  3769 Nov  8 17:01 wp-config.php
drwxr-xr-x  6 www-data www-data  4096 Feb  9 22:51 wp-content
-rwxr-xr-x  1 www-data www-data  3939 Jul 30  2020 wp-cron.php
drwxr-xr-x 25 www-data www-data 16384 Nov 10 14:18 wp-includes
-rwxr-xr-x  1 www-data www-data  2496 Feb  6  2020 wp-links-opml.php
-rwxr-xr-x  1 www-data www-data  3900 May 15  2021 wp-load.php
-rwxr-xr-x  1 www-data www-data 45463 Apr  6  2021 wp-login.php
-rwxr-xr-x  1 www-data www-data  8509 Apr 14  2020 wp-mail.php
-rwxr-xr-x  1 www-data www-data 22297 Jun  1  2021 wp-settings.php
-rwxr-xr-x  1 www-data www-data 31693 May  7  2021 wp-signup.php
-rwxr-xr-x  1 www-data www-data  4747 Oct  8  2020 wp-trackback.php
-rwxr-xr-x  1 www-data www-data  3236 Jun  8  2020 xmlrpc.php
```

## Scanning

### nmap

```bash
nmap -sV --script=http-wordpress-brute.nse,http-wordpress-enum.nse,http-wordpress-users -p80 <IP>

```

### wpscan

```bash
# Basic Scan
wpscan --url http://10.10.248.119 -o wpscan.log
# Enumerate vulnerable plugins, themes, and users
wpscan --url http://10.10.248.119 -e vp,vt,u -o wpscan.log --api-token <>
# Brute Forcing Login
wpscan --url http://10.10.128.156/ -U users.txt -P /usr/share/wordlists/rockyou.txt -vv
```

## Exploitation

### Plugins

* Can add modified WordPress plugin header to the top of the reverse shell file
* Upload reverse shell plugin as a zip file
