# 53 (DNS)

## Enumeration

When seeing port 53 show up, you can add the IP of the host to the resolv.conf file

`nameserver <IP>`

### Hostname Leak

#### nslookup

```bash
nslookup
> server <IP>
>127.0.0.1
>127.0.0.2
><IP>
```

### Banner Grabbing

```bash
dig version.bind CHAOS TXT @DNS
```

### More Info

#### nslookup

```bash
root@INE:~# nslookup
> server 192.212.168.3
> set q=NS  # Can also change per record i.e. A, MX, etc.
> witrap.com  # Chage the hostname as needed
# Should return additional domains
```

#### dnsenum

```bash
dnsenum target # Zone transfer
```

#### nmap

```bash
nmap -n --script "(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport" <IP>
nmap --script dns-nsid
```

#### gobuster

```bash
gobuster dns -d cronos.htb -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt 
```

#### Metasploit

```bash
auxiliary/gather/enum_dns # Perform enumeration actions
```

### Zone Transfers

#### dig / fierce

```bash
dig axfr <DOMAIN> @ns1.test.com
dig axfr @<DNS_IP>  # Try zone transfer without domain
dig axfr @<DNS_IP> <DOMAIN>  # Try zone transfer guessing the domain
fierce --domain <DOMAIN> --dns-servers <DNS_IP>  # Will try to perform a zone transfer against every authoritative name server and if this doesn'twork, will launch a dictionary attack
dig @192.212.168.3 witrap.com -t AXFR +nocookie
```

#### Host

```bash
# Zone transfer
sudo vim /etc/hosts
10.10.10.123  friendzone.red
host -l 10.10.10.123 friendzone.red # Zone Transfer
host -t axfr witrap.com 192.212.168.3
```

#### dnsrecon

```bash
dnsrecon -d target.com -t axfr # Zone Transfer
dnsrecon -d target.com -D words.txt -t brt # Brute force domain
dnsrecon -d <DOMAIN> -a
```

## Brute Force

### Reverse

#### dnsrecon

```bash
dnsrecon -d <DOMAIN>
dnsrecon -d active.htb -a -n <IP_DNS> # Zone transfer
dnsrecon -r 127.0.0.0/24 -n <Target IP> -d <IP-DNS>  # DNS reverse of all of the addresses
dnsrecon -r 127.0.0.1/24 -n <Target IP> -d <IP-DNS>  # DNS reverse of all of the addresses
dnsrecon -r <IP_DNS>/24 -n <IP_DNS>  # DNS reverse of all of the addresses
dnsrecon -d <IP> -r 10.0.0.0/8
```

### Subdomain

#### dnsrecon / dnscan

```bash
dnsrecon -D subdomains-1000.txt -d <DOMAIN> -n <IP_DNS>
dnscan -d <domain> -r -w subdomains-1000.txt # Bruteforce subdomains in recursive way, https://github.com/rbsec/dnscan
```
