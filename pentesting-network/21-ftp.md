# 21 (FTP)

## Enumeration

### Banner Grabbing

```bash
nc <IP> 21  # Grab headers
telnet -vn <IP> 21
openssl s_client -connect crossfit.htb:21 -starttls ftp #Get certificate if any
```

### Connections

#### Anonymous Login

* `anonymous:anonymous`
* `anonymous:`
* `guest:`
* `ftp:ftp`
* `admin:admin`

```bash
ftp <IP>
ftp -p <IP>  # Passive mode login
>ls -a  # List all files (even hidden) (yes, they could be hidden)
>binary  # Set transmission to binary instead of ascii
>ascii  # Set transmission to ascii instead of binary
>bye  # exit
```

#### Downloading

```bash
PASSIVE
BINARY
get <FILE>
wget -m ftp://anonymous:anonymous@10.10.10.98  # Donwload all files
wget -m --no-passive ftp://anonymous:anonymous@10.10.10.98  # Download all files
```

#### Uploading

```bash
PASSIVE
BINARY
put <FILE>
```

### nmap Scripts

```bash
nmap --script=ftp-anon,ftp-libopie,ftp-proftpd-backdoor,ftp-vsftpd-backdoor,ftp-vuln-cve2010-4221,tftp-enum -p 21 <IP>
nmap --script ftp-* -p 21 <ip>
```

### Checks

* [ ] Check for anonymous access
* [ ] Check if you can upload a file to trigger a webshell through webapp
* [ ] Check if you can download backup files to extract included passwords
* [ ] Check the version of FTP for exploits

## Brute Forcing

```bash
hydra -V -f -L <USERS_LIST> -P <PASSWORDS_LIST> ftp://<IP> -u -vV
hydra -l root -P passwords.txt [-t 32] <IP> ftp
```
